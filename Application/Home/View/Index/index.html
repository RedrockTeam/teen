<!DOCTYPE html>
<html 
	lang="zh-CN"
	data-add="{:U('Question/commit_voice')}"
	data-del="{:U('Question/delete_vioce')}"
	data-index="{:U('Index/index')}"
	data-login="{:U('User/login')}"
	data-detail="{:U('Question/detail')}"
	data-praise="{:U('Question/vote')}"
	data-comment="{:U('Question/commit_comment')}"
	data-personal="{:U('User/get_voice')}"
	data-loadmore="{:U('Index/load_home_data')}"
	data-chariLogin="{:U('User/chair_login')}"
>
	<head>
		<meta charset="UTF-8">
		<title>青年之声</title>
		<link rel="stylesheet" href="__PUBLIC__/home/css/index.css">
		<link rel="stylesheet" href="http://apps.bdimg.com/libs/animate.css/3.1.0/animate.min.css">
	</head>
	<body>
		<div id="header">
			<div class="nav-bar">
				<ul>
					<li class="school-logo">
						<img src="__PUBLIC__/home/images/cqupt.png">
					</li>
					<li class="nav">
						<a href="###">首页</a>
					</li>
					<li class="nav">
						<a href="http://xsc.cqupt.edu.cn/xyfd">学业辅导</a>
					</li>
					<li class="nav">
						<a href="http://cqupt.ncss.org.cn/jixun/Info/IeOnly.html">职业规划</a>
					</li>
					<li class="nav">
						<a href="http://202.202.43.69/XinLiweb">心理互助</a>
					</li>
					<li class="nav">
						<a href="http://president-mail.cqupt.edu.cn">书记校长信箱</a>
					</li>
					<li class="nav">
						<a href="http://job.cqupt.edu.cn">就业中心</a>
					</li>
					<li class="nav">
						<a href="http://jjc.cqupt.edu.cn">后勤中心</a>
					</li>
				</ul>
			</div>
			<div class="login-reg-btn">
				<if condition="$Think.session.username neq ''">
					<span><a href="__MODULE__/User/get_voice">个人中心</a></span>
					<span><a href="__MODULE__/User/logout">退出</a></span>
				<else/>
					<span class="open-login-view">登录</span>
				</if>
			</div>
		</div>
		
		<div id="main">
			
			<div class="teen-logo">
				<img src="__PUBLIC__/home/images/logo.png">
			</div>
				
			<div class="main-content">

				<div class="left-sidebar">
					<div class="add-question-container">
						<p>提问框</p>
						<div class="at-question">
							<button>向学霸提问</button>
						</div>
						<div class="public-question">
							<button>公开提问</button>
						</div>
					</div>
					
					<div class="website-link">
						<p>网站链接</p>
						<ul>
							<li>
								<a href="http://xsc.cqupt.edu.cn/xyfd">学业辅导</a>
							</li>
							<li>
								<a href="http://cqupt.ncss.org.cn/jixun/Info/IeOnly.html">职业规划</a>
							</li>
							<li>
								<a href="http://202.202.43.69/XinLiweb">心理互助</a>
							</li>
							<li>
								<a href="http://president-mail.cqupt.edu.cn">书记校长信箱</a>
							</li>
							<li>
								<a href="http://job.cqupt.edu.cn">就业中心</a>
							</li>
							<li>
								<a href="http://jjc.cqupt.edu.cn">后勤中心</a>
							</li>
				        	<li>
				        		<a href="http://hongyan.cqupt.edu.cn/web/">网址大全</a>
				        	</li>
				        	<li>
				        		<a href="http://www.cqupt.edu.cn/">学校主页</a>
				        	</li>
				        	<li>
				        		<a href="http://hongyan.cqupt.edu.cn/chat/">校领导接待室</a>
				        	</li>
				        	<li>
				        		<a href="http://222.177.140.105/index.shtml">学工在线</a>
				        	</li>
				        	<li>
				        		<a href="http://bxf.cqupt.edu.cn/Bscore/">素质教育网</a>
				        	</li>
				        	<li>
				        		<a href="http://qnzs.youth.cn">团中央青年之声</a>
				        	</li>
						</ul>
					</div>

				</div>
				
				<div class="middle">
					<div class="list-title">
						<div class="all-question on-focus">
							所有提问
						</div>
					</div>
					
					<div class="question-list">
						<volist name="voice" id="v">
							<div class="question" data-index="{$v.id}">
								<div class="question-header">
									<div class="user-avatar">
										<img src="{$v.touxiang}" >
									</div>
									<div class="user-name">{$v.postername}</div>
									<div class="post-date">
										<span>{$v.time|date="Y年m月d日", ###}</span>
										<span>{$v.time|date="H:i", ###}</span>
									</div>
								</div>
								<div class="question-body">
									<div class="question-title">
										<strong>{$v.title}</strong>
										<if condition="$v.gettername eq 'public'">
											<span>公共提问</span>
										<else/>
											<span>@{$v.gettername}</span>
										</if>
									</div>
									<div class="question-content">{$v.question}</div>
								</div>
								<div class="question-footer">
									<div class="question-praise">
										<if condition="$v.is_voted eq 'true'">
											<i class="iconfont" data-id="{$v.id}">&#xe604;</i>
										<else/>
											<i class="iconfont" data-id="{$v.id}">&#xe605;</i>
										</if>
										<span>{$v.vote}</span>
									</div>
									<div class="question-comments-list">
										<volist name="v.comments" id="k">
											<div class="question-comment">
												<div class="comment-header">
													<img src="{$k.touxiang}" width="28" height="28">
												</div>
												<div class="comment-body">
													<span class="comment-content">
														<strong class="comment-user-name">{$k.username}</strong>:&nbsp;
														{$k.comment}
													</span>
													<div class="comment-date">{$k.time|date="H:i", ###}</div>
												</div>
											</div>
										</volist>
									</div>
									<div class="question-reply">
										<form>
											<input type="hidden" name="id" value="{$v.id}">
											<input type="text" name="comment" placeholder="请输入回复内容">
											<button type="button" class="add-comment">回复</button>
										</form>
									</div>
								</div>
							</div>
						</volist>
					</div>
					
					<div class="loading-more">加载更多</div>

				</div>
				
				<div class="right-sidebar">
					<div class="weico-link-list">
						<p>微博链接</p>
						<ul class="weico-avatar-list">
							<volist name="weibo" id="v" key="k">
								<li class="<?php if ($k % 3 == 2) echo "weico-avatar-middle"; ?>">
									<img src="{$v.img}">
									<span><a href="{$v.url}">{$v.name}</a></span>
								</li>
							</volist>
						</ul>
					</div>

					
					<div class="president-list">
						<p>主席信息</p>
						<ul>
							<volist name="chairman" id="v">
								<li>
									<img src="{$v.picture}" height="43" width="43">
									<div class="president-info">
										<p class="president-name">{$v.chairname}</p>
										<p class="president-dep">WEB研发部</p>
									</div>
									<div class="handle">
										<p class="at-me" data-id="{$v.id}">向他提问</p>
									</div>
								</li>
							</volist>
						</ul>
						<div class="show-more-president">
							<div class="prev">上一页</div>
							<div class="next">下一页</div>
						</div>
					</div>
					
				</div>

			</div>	
			
		</div>

		<div id="footer">
			<p>关于红岩网校 | 开发团队 | 指出错误 | 管理入口</p>
			<p>地址:重庆市南岸区南山街道崇文路2号重庆邮电大学 联系电话:62461084/62487910</p>
			<p>本网站由红岩网校工作站负责开发管理,不经红岩网校委员会书面同意,不得进行转载</p>	
		</div>

		<!-- 遮罩层 -->
		<div class="dimmer" style=""></div>

		<!-- 回到顶部 -->
		<div class="return-top">
			<i class="iconfont">&#xe601;</i>
		</div>

		<!-- 向主席提问 -->
		<div id="add-question-view-at">
			<div class="add-question-view-at-header">
				<strong>向学霸提问</strong>
				<i class="iconfont">&#xe603;</i>
			</div>
			<div class="add-question-view-at-body">
				<form class="add-private-question-form">
					<div class="form-control">
						<select name="type">
							<volist name="chairman" id="v">
								<option value="{$v.id}">{$v.chairname}</option>
							</volist>
						</select>
					</div>
					<div class="form-control">
						<input type="text" name="title" placeholder="请输入标题">
					</div>
					<div class="form-control">
						<textarea name="content" placeholder="请输入内容"></textarea>
					</div>
					<div class="form-control">
						<button type="button">提问</button>
					</div>
				</form>
			</div>
		</div>


		<!-- 向学霸提问 -->
		<!-- 
			<div id="add-question-view-xueba">
				<div class="add-question-view-xueba-header">
					<strong>@提问</strong>
					<i class="iconfont">&#xe603;</i>
				</div>
				<div class="add-question-view-xueba-body">
					<form class="add-xueba-question-form">
						<div class="form-control">
							<select name="type">
								<volist name="chairman" id="v">
									<option value="{$v.id}">{$v.chairname}</option>
								</volist>
							</select>
						</div>
						<div class="form-control">
							<input type="text" name="title" placeholder="请输入标题">
						</div>
						<div class="form-control">
							<textarea name="content" placeholder="请输入内容"></textarea>
						</div>
						<div class="form-control">
							<button type="button">提问</button>
						</div>
					</form>
				</div>
			</div>
		-->


		<!-- 公开提问 -->
		<div id="add-question-view-public">
			<div class="add-question-view-public-header">
				<strong>公开提问</strong>
				<i class="iconfont">&#xe603;</i>
			</div>
			<div class="add-question-view-public-body">
				<form class="add-public-question-form">
					<input type="hidden" name="type" value="public">
					<div class="form-control">
						<input type="text" name="title" placeholder="请输入标题">
					</div>
					<div class="form-control">
						<textarea name="content" placeholder="请输入内容"></textarea>
					</div>
					<div class="form-control">
						<button type="button">提问</button>
					</div>
				</form>
			</div>
		</div>
	

		<!-- 登录页面 -->
		<div id="login-view-container">
			
			<div class="login-view-header">
				<strong>登录</strong>
				<i class="iconfont">&#xe603;</i>
			</div>
			<div class="login-view-body">
				<form class="user-form">
					<div class="form-control">
						<label for="">
							<span>登录账号:</span>
							<strong style="color: #9a9a9a">学霸用户</strong>
							<strong>/</strong>
							<strong style="color: #5082c7">普通用户</strong>
						</label>
						<input type="text" name="username" placeholder="请输入学号或者教师一卡通号">
					</div>
					<div class="form-control">
						<label for="">登录密码:</label>
						<input type="password" name="password" placeholder="请输入密码">
					</div>
					<div class="form-control">
						<button type="button">登录</button>
					</div>
				</form>

				<form class="chairman-form" style="display: none">
					<div class="form-control">
						<label for="">
							<span>登录账号:</span>
							<strong style="color: #5082c7">学霸用户</strong>
							<strong>/</strong>
							<strong style="color: #9a9a9a">普通用户</strong>
						</label>
						<input type="text" name="chairname" placeholder="请输入学霸姓名">
					</div>
					<div class="form-control">
						<label for="">登录密码:</label>
						<input type="password" name="password" placeholder="请输入密码">
					</div>
					<div class="form-control">
						<button type="button">登录</button>
					</div>
				</form>
			</div>

		</div>

	</body>
	<script src="__PUBLIC__/home/js/jquery.min.js"></script>
	<script src="http://cdn.staticfile.org/jquery-cookie/1.4.1/jquery.cookie.min.js"></script>
	<script src="__PUBLIC__/home/js/layer.js"></script>

	
	<script>

			/*
			 	这是一段不可维护代码
			 	手机端的代码可以看
			 	我实在不想写了
			 	姚老板说明天必须上线
			 	那就先这样了吧
			 	如果你要改这段代码
			 	祝你好运
			 */	

			$(function () {


				function isLogin () {
					if ($.cookie('stunum') == '' || $.cookie('stunum') == undefined) {
						return false;
					} else {
						return true;
					}
				}



				// 登录文字定位
				var rightPosition = $('.nav-bar li:eq(7)').offset().left + 17 + $('.nav-bar li:eq(7)').width();
				$('.login-reg-btn').css({
					'opacity': 1,
					'left': rightPosition - $('.login-reg-btn').width()
				});


				$(window).scroll(function(event) {
					if ($(window).scrollTop() > $('.middle').offset().top) {
						$('.return-top').css({
							display: 'block',
							left: $('#main .right-sidebar').offset().left	
						});
					} else {
						$('.return-top').css('display', 'none');
					}
				});

				$('.return-top').on('click', function () {
					$("html,body").animate({scrollTop:0}, 500);
				});


				// 打开@提问框
				$('.at-question').click(function () {
					if (isLogin()) {
						$('.dimmer').css({
							display: 'block',
							top: $(document).scrollTop()
						});
						$('.add-private-question-form option:eq(0)').attr('selected', true);
						$('#add-question-view-at').css({
							display: 'block',
							top: ($(window).height() - 467) / 2 + $(window).scrollTop(),
							left: ($(window).width() - 664) / 2
						}).removeClass('bounceOutUp').addClass('animated bounceInDown');
						$('body').css('overflow', 'hidden');
					} else {
						layer.alert('你还未登录, 不能进行此操作', {icon: 5});
					}
				});

				// 关闭@提问框
				$('#add-question-view-at i').click(function () {
					$('.dimmer').css('display', 'none');
					$('#add-question-view-at').removeClass('bounceInDown').addClass('bounceOutUp');
					$('body').css('overflow', 'auto');
				});

				/*================================================================================*/

				// 打开公开提问框
				$('.public-question').click(function () {
					if (isLogin()) {
						$('.dimmer').css({
							display: 'block',
							top: $(document).scrollTop()
						});
						$('#add-question-view-public').css({
							display: 'block',
							top: ($(window).height() - 467) / 2 + $(window).scrollTop(),
							left: ($(window).width() - 664) / 2
						}).removeClass('bounceOutUp').addClass('animated bounceInDown');
						$('body').css('overflow', 'hidden');
					} else {
						layer.alert('你还未登录, 不能进行此操作', {icon: 5});
					}
				});

				// 关闭公开提问框
				$('#add-question-view-public i').click(function () {
					$('.dimmer').css('display', 'none');
					$('#add-question-view-public').removeClass('bounceInDown').addClass('bounceOutUp');
					$('body').css('overflow', 'auto');
				});

				// 格式化时间
				function formatTime (timestamp, type) {
					var time = new Date(timestamp * 1000);
					var year = time.getYear();
					var month = time.getMonth() + 1;
					var day = time.getDate();
					var hour = time.getHours();
					var min = time.getMinutes();
					if (type === 'year') {
						return 	'20' + (String(year).substr(1)) + '年' + month + '月' + day + '日';
					} else {
						if (min < 10) {
							min = '0' + min;
						}
						return hour + ':' + min;
					}
				}


				function questionTemplate (data) {
					var _question = '', _temp = '', type, vote;
					vote = data.vote == undefined ? 0 : data.vote;
					if (data.gettername == 'public') {
						type = '公共提问';
					} else {
						if (typeof data.gettername == 'number') {
							$.each($('option'), function (index, option) {
								if ($(option).val() == data.gettername) {
									type = '@' + $(option).text();
								}
							});
						} else {
							type = '@' + data.gettername;
						}
					}

					if (data.is_voted == 'false' || !data.is_voted) {
						icon = '&#xe605;';
					} else {
						icon = '&#xe604;';
					}

					var comment = comments = '';
					if (data.comments && data.comments.length > 0) {
						for (var i = 0; i < data.comments.length; i++) {
							comment += '<div class="question-comment">';
								comment += '<div class="comment-header">'
									comment += '<img src="'+ data.comments[i].touxiang  +'" width="28" height="28">';
								comment += '</div>';
								comment += '<div class="comment-body">';
									comment += '<span class="comment-content">';
										comment += '<strong class="comment-user-name">'+ data.comments[i].username +'</strong>:&nbsp;'+ data.comments[i].comment +'';
									comment += '</span>';
									comment += '<div class="comment-date">'+ formatTime(data.comments[i].time) +'</div>';
								comment += '</div>';
							comment += '</div>';
							comments += comment;
							comment = '';
						}
					} else {
						comments = '';
					}

					_question += '<div class="question" data-index="'+ data.id +'">';
						// 头部
						_question += '<div class="question-header">';
							_question += '<div class="user-avatar">';
								_question += '<img src="'+ data.touxiang +'" >';
							_question += '</div>';
							_question += '<div class="user-name">'+ data.postername +'</div>';
							_question += '<div class="post-date">';
								_question += '<span>'+ formatTime(data.time, 'year') +'</span>&nbsp;';
								_question += '<span>'+ formatTime(data.time) +'</span>';
							_question += '</div>';
						_question += '</div>';
						// 内容
						_question += '<div class="question-body">';
							_question += '<div class="question-title">';
								_question += '<strong>'+ data.title +'</strong>';
								_question += '<span>'+ type +'</span>';
							_question += '</div>';
							_question += '<div class="question-content">'+ data.question +'</div>';
						_question += '</div>';
						// 尾部
						_question += '<div class="question-footer">';
							_question += '<div class="question-praise">';
								_question += '<i class="iconfont" data-id="'+ data.id +'">'+ icon +'</i>&nbsp;';
								_question += '<span>'+ vote +'</span>';
							_question += '</div>';
							_question += '<div class="question-comments-list">'+ comments +'</div>';
							_question += '<div class="question-reply">';
								_question += '<form>';
									_question += '<input type="hidden" name="id" value="'+ data.id +'">';
									_question += '<input type="text" name="comment" placeholder="请输入回复内容">';
									_question += '<button type="button" class="add-comment">回复</button>';
								_question += '</form>';
							_question += '</div>';
						_question += '</div>';
					_question += '</div>';
					_temp = _question;
					_question = comments = '';
					return _temp
				}

				// 添加问题
				function addQuestion (formName) {

					var title = $.trim($(formName).find('input[name=title]').val());
					var content = $.trim($(formName).find('textarea[name=content]').val());


					if (!title.length) {
						layer.msg('标题不能为空', {time: 800});
						return;
					} else {
						if (title.length > 40) {
							layer.msg('标题不能多于40字', {time: 800});
							return;
						}
					}

					if (!content.length) {
						layer.msg('内容不能为空', {time: 800});
						return;
					} else {
						if (content.length < 20) {
							layer.msg('内容不能少于20字', {time: 800});
							return;
						}
						if (content.length > 140) {
							layer.msg('内容不能多于140字', {time: 800});
							return;
						}
					}


					if (isLogin()) {
						$.ajax({
							url: $('html').data('add'),
							type: 'POST',
							data: $(formName).serialize()
						}).done(function (response) {
							if (response.status == 200) {
								layer.alert('提问成功', {icon: 6}, function (index) {
									layer.close(index);
									$(formName).get(0).reset();
									$('.dimmer').css('display', 'none');
									$('body').css('overflow', 'auto');
									$(formName).parent().parent().removeClass('bounceInDown').addClass('bounceOutUp');
								});
								$('.question-list').prepend(questionTemplate(response.data));
							} else {
								layer.alert('提问失败, 请刷新试试', {icon: 5}, function (index) {
									layer.close(index);
								});
							}
						}).fail(function () {
							layer.alert('提问失败, 请刷新试试', {icon: 5}, function (index) {
								layer.close(index);
							});
						}).always(function () {
							
						});
					} else {
						layer.alert('你还未登录, 不能进行此操作', {icon: 5});
					}
				}


				$('.add-public-question-form button').on('click', function () {
					addQuestion('.add-public-question-form');
				})

				$('.add-private-question-form button').on('click', function () {
					addQuestion('.add-private-question-form');
				})

				


				// 添加评论
				$('.question-list').on('click', '.add-comment', function () {

					if (isLogin()) {
						var self = this;
						if (!$.trim($(this).parent().find('input[name=comment]').val())) {
							layer.msg('评论内容不能为空', {time: 1000});
							return;
						}
						$.ajax({
							url: $('html').data('comment'),
							type: 'POST',
							data: $(self).parent().serialize(),
							beforeSend: function () {
								$(self).css('background-color', '#c0c0c0');
							}
						}).done(function (response) {
							var html = '';
							if (response.status == 200) {
								html += '<div class="question-comment">';
									html += '<div class="comment-header">';
										html += '<img src="'+ response.data.touxiang +'" width="28" height="28">';
									html += '</div>';
									html += '<div class="comment-body">';
										html += '<span class="comment-content">';
											html += '<strong class="comment-user-name">'+ response.data.username +'</strong>:&nbsp;';
											html += response.data.comment;
										html += '</span>';
										html += '<div class="comment-date">'+ response.data.time +'</div>';
									html += '</div>';
								html += '</div>';
								$(self).parents('.question-reply').prev().append(html);
							} else {
								layer.alert('评论有误, 请重新评论', {icon: 5});
							}
						}).fail(function() {
							layer.alert('系统好像出了点问题, 请刷新试试!', {icon: 5});
						}).always(function () {
							$(self).parent().find('input[name=comment]').val('');
							$(self).css('background-color', '#3686c5');
						});
					} else {
						layer.alert('你还未登录, 不能进行此操作', {icon: 5});
					}
				});

				// 点赞
				$('.question-list').on('click', '.question-praise i', function () {
					if (isLogin()) {
						var self = this;
						$.ajax({
							url: $('html').attr('data-praise'),
							type: 'POST',
							data: {id: $(self).attr('data-id')}
						}).done(function (response) {
							if (response.status === 200) {
								$(self).html('&#xe604;');
								$(self).next().html(Number($(self).next().text()) + 1);
								layer.msg('点赞成功', {time: 500});
							} else {
								layer.msg('不能重复点赞', {time: 500});
							}
						}).fail(function() {
							console.log("error");
						}).always(function() {
							console.log("complete");
						});
					} else {
						layer.alert('你还未登录, 不能进行此操作', {icon: 5});
					}
				});
				


				// 打开登录框
				$('.open-login-view').on('click', function () {
					$('.dimmer').css({
						display: 'block',
						top: $(document).scrollTop()
					});
					$('#login-view-container').css({
						display: 'block',
						top: ($(window).height() - 250) / 2,
						left: ($(window).width() - 340) / 2
					}).removeClass('bounceOutUp').addClass('animated bounceInDown');
					$('body').css('overflow', 'hidden');
				});

				// 关闭登陆框
				$('#login-view-container i').click(function () {
					$('.dimmer').css('display', 'none');
					$('#login-view-container').removeClass('bounceInDown').addClass('bounceOutUp');
					$('body').css('overflow', 'auto');
				});

				$('.user-form strong:eq(0)').on('click', function () {
					$('.user-form').css('display', 'none');
					$('.chairman-form').css('display', 'block');
				});

				$('.chairman-form strong:eq(2)').on('click', function () {
					$('.chairman-form').css('display', 'none');
					$('.user-form').css('display', 'block');
				});

				// 学生和教师登录
				$('.user-form button').click(function () {
					$.ajax({
						url: $('html').data('login'),
						type: 'POST',
						data: $('.user-form').serialize()
					}).done(function (response) {
						if (response.status == 200) {
							layer.alert('登录成功!', {icon: 6}, function (index) {
								layer.close(index);
								$('.dimmer').css('display', 'none');
								$('#login-view-container').removeClass('bounceInDown').addClass('bounceOutUp');
								$('body').css('overflow', 'auto');
							});
							location.reload();
						} else {
							layer.msg('用户名或密码有误', {icon: 5});
							$('.user-form').get(0).reset();
						}
					}).fail(function() {
						alert('cuowu');
					});
				});

				// 主席登录
				$('.chairman-form button').click(function () {
					$.ajax({
						url: $('html').attr('data-chariLogin'),
						type: 'POST',
						data: $('.chairman-form').serialize()
					}).done(function (response) {
						if (response.status == 200) {
							layer.alert('登录成功!', {icon: 6}, function (index) {
								layer.close(index);
								$('.dimmer').css('display', 'none');
								$('#login-view-container').removeClass('bounceInDown').addClass('bounceOutUp');
								$('body').css('overflow', 'auto');
								location.reload();
							});
						} else {
							layer.msg('用户名或密码有误', {icon: 5});
							$('.chairman-form').get(0).reset();
						}
					}).fail(function() {
						alert('cuowu');
					});
				});

				// 加载更多
				$('.loading-more').on('click', function () {
					
					var layerIndex, indexArray = [];
					$.each($('.question'), function (index, el) {
						indexArray.push($(el).data('index'));
					});
					$.ajax({
						url: $('html').data('loadmore'),
						type: 'POST',
						data: {id: Math.min.apply(Math, indexArray)},
						beforeSend: function () {
							layerIndex = layer.load(2000, {
							    shade: [0.1, '#000']
							});
						}
					}).done(function (response) {
						if (response.length == 0) {
							layer.msg('没有更多了!', {time: 1000});
						} else {
							$.each(response, function(index, data) {
								console.log(data);
								$('.question-list').append(questionTemplate(data));
							});
						}
					}).fail(function() {
						layer.msg('加载错误!', {time: 1000});
					}).always(function() {
						layer.close(layerIndex);
					});
					
				});

				$('.president-list').on('click', '.at-me', function () {
					if (isLogin()) {
						var self = this;
						var id = $(self).data('id');
						$.each($('#add-question-view-at option'), function(index, option) {
							if ($(option).val() == id) {
								$(option).attr('selected', true);
							}
						});
						$('.dimmer').css({
							display: 'block',
							top: $(document).scrollTop()
						});
						$('#add-question-view-at').css({
							display: 'block',
							top: ($(window).height() - 467) / 2 + $(window).scrollTop(),
							left: ($(window).width() - 664) / 2
						}).removeClass('bounceOutUp').addClass('animated bounceInDown');
						$('body').css('overflow', 'hidden');
					} else {
						layer.alert('你还未登录, 不能进行此操作', {icon: 5});
					}
				})


				

			})

	</script>

</html>